{"version":3,"file":"index.es.js","sources":["../src/combobox.store.ts","../src/utils/getTextFromTrigger.ts","../src/onChangeCombobox.ts","../../../node_modules/is-hotkey/lib/index.js","../src/utils/getNextNonDisabledIndex.ts","../src/utils/getNextWrappingIndex.ts","../src/onKeyDownCombobox.ts","../src/createComboboxPlugin.ts","../src/hooks/useComboboxContent.ts","../src/hooks/useComboboxControls.ts","../src/hooks/useComboboxItem.tsx"],"sourcesContent":["import { createStore, StateActions, StoreApi } from '@udecode/plate-common';\nimport { Range } from 'slate';\n\nimport { ComboboxOnSelectItem, NoData, TComboboxItem } from './types';\n\nexport type ComboboxStateById<TData = NoData> = {\n  /**\n   * Combobox id.\n   */\n  id: string;\n\n  /**\n   * Items filter function by text.\n   * @default (value) => value.text.toLowerCase().startsWith(search.toLowerCase())\n   */\n  filter?: (search: string) => (item: TComboboxItem<TData>) => boolean;\n\n  /**\n   * Sort filtered items before applying maxSuggestions.\n   */\n  sort?: (\n    search: string\n  ) => (a: TComboboxItem<TData>, b: TComboboxItem<TData>) => number;\n\n  /**\n   * Max number of items.\n   * @default items.length\n   */\n  maxSuggestions?: number;\n\n  /**\n   * Trigger that activates the combobox.\n   */\n  trigger: string;\n\n  /**\n   * Regular expression for search, for example to allow whitespace\n   */\n  searchPattern?: string;\n\n  /**\n   * Called when an item is selected.\n   */\n  onSelectItem: ComboboxOnSelectItem<TData> | null;\n\n  /**\n   * Is opening/closing the combobox controlled by the client.\n   */\n  controlled?: boolean;\n};\n\nexport type ComboboxStoreById<TData = NoData> = StoreApi<\n  string,\n  ComboboxStateById<TData>,\n  StateActions<ComboboxStateById<TData>>\n>;\n\nexport type ComboboxState<TData = NoData> = {\n  /**\n   * Active id (combobox id which is opened).\n   */\n  activeId: string | null;\n\n  /**\n   * Object whose keys are combobox ids and values are config stores\n   * (e.g. one for tag, one for mention,...).\n   */\n  byId: Record<string, ComboboxStoreById>;\n\n  /**\n   * Unfiltered items.\n   */\n  items: TComboboxItem<TData>[];\n\n  /**\n   * Filtered items\n   */\n  filteredItems: TComboboxItem<TData>[];\n\n  /**\n   * Highlighted index.\n   */\n  highlightedIndex: number;\n\n  /**\n   * Range from the trigger to the cursor.\n   */\n  targetRange: Range | null;\n\n  /**\n   * Text after the trigger.\n   */\n  text: string | null;\n};\n\nconst createComboboxStore = (state: ComboboxStateById) =>\n  createStore(`combobox-${state.id}`)(state);\n\nexport const comboboxStore = createStore('combobox')<ComboboxState>({\n  activeId: null,\n  byId: {},\n  highlightedIndex: 0,\n  items: [],\n  filteredItems: [],\n  targetRange: null,\n  text: null,\n})\n  .extendActions((set, get) => ({\n    setComboboxById: <TData = NoData>(state: ComboboxStateById<TData>) => {\n      if (get.byId()[state.id]) return;\n\n      set.state((draft) => {\n        draft.byId[state.id] = createComboboxStore(\n          state as unknown as ComboboxStateById\n        );\n      });\n    },\n    open: (state: Pick<ComboboxState, 'activeId' | 'targetRange' | 'text'>) => {\n      set.mergeState(state);\n    },\n    reset: () => {\n      set.state((draft) => {\n        draft.activeId = null;\n        draft.highlightedIndex = 0;\n        draft.filteredItems = [];\n        draft.items = [];\n        draft.text = null;\n        draft.targetRange = null;\n      });\n    },\n  }))\n  .extendSelectors((state) => ({\n    isOpen: () => !!state.activeId,\n  }));\n\nexport const useComboboxSelectors = comboboxStore.use;\nexport const comboboxSelectors = comboboxStore.get;\nexport const comboboxActions = comboboxStore.set;\n\nexport const getComboboxStoreById = (id: string | null) =>\n  id ? comboboxSelectors.byId()[id] : null;\n\nexport const useActiveComboboxStore = () => {\n  const activeId = useComboboxSelectors.activeId();\n  const comboboxes = useComboboxSelectors.byId();\n\n  return activeId ? comboboxes[activeId] : null;\n};\n","import {\n  escapeRegExp,\n  getEditorString,\n  getPointBefore,\n  getRange,\n  TEditor,\n  Value,\n} from '@udecode/plate-common';\nimport { Point } from 'slate';\n\n/**\n * Get text and range from trigger to cursor.\n * Starts with trigger and ends with non-whitespace character.\n */\nexport const getTextFromTrigger = <V extends Value>(\n  editor: TEditor<V>,\n  {\n    at,\n    trigger,\n    searchPattern = `\\\\S+`,\n  }: { at: Point; trigger: string; searchPattern?: string }\n) => {\n  const escapedTrigger = escapeRegExp(trigger);\n  const triggerRegex = new RegExp(`(?:^|\\\\s)${escapedTrigger}`);\n\n  let start: Point | undefined = at;\n  let end: Point | undefined;\n\n  while (true) {\n    end = start;\n\n    if (!start) break;\n\n    start = getPointBefore(editor, start);\n    const charRange = start && getRange(editor, start, end);\n    const charText = getEditorString(editor, charRange);\n\n    if (!charText.match(searchPattern)) {\n      start = end;\n      break;\n    }\n  }\n\n  // Range from start to cursor\n  const range = start && getRange(editor, start, at);\n  const text = getEditorString(editor, range);\n\n  if (!range || !text.match(triggerRegex)) return;\n\n  return {\n    range,\n    textAfterTrigger: text.slice(trigger.length),\n  };\n};\n\n// export const matchesTriggerAndPattern = (\n//   editor: TEditor<V>,\n//   { at, trigger, pattern }: { at: Point; trigger: string; pattern: string }\n// ) => {\n//   // Point at the start of line\n//   const lineStart = getPointBefore(editor, at, { unit: 'line' });\n//\n//   // Range from before to start\n//   const beforeRange = lineStart && getRange(editor, lineStart, at);\n//\n//   // Before text\n//   const beforeText = getEditorString(editor, beforeRange);\n//\n//   // Starts with char and ends with word characters\n//   const escapedTrigger = escapeRegExp(trigger);\n//\n//   const beforeRegex = new RegExp(`(?:^|\\\\s)${escapedTrigger}(${pattern})$`);\n//\n//   // Match regex on before text\n//   const match = !!beforeText && beforeText.match(beforeRegex);\n//\n//   // Point at the start of mention\n//   const mentionStart = match\n//     ? getPointBefore(editor, at, {\n//         unit: 'character',\n//         distance: match[1].length + trigger.length,\n//       })\n//     : null;\n//\n//   // Range from mention to start\n//   const mentionRange = mentionStart && getRange(editor, mentionStart, at);\n//\n//   return {\n//     range: mentionRange,\n//     match,\n//   };\n// };\n","import { isCollapsed, PlateEditor, Value } from '@udecode/plate-common';\nimport { Range } from 'slate';\n\nimport { comboboxActions, comboboxSelectors } from './combobox.store';\nimport { getTextFromTrigger } from './utils/getTextFromTrigger';\n\n/**\n * For each combobox state (byId):\n * - if the selection is collapsed\n * - if the cursor follows the trigger\n * - if there is text without whitespaces after the trigger\n * - open the combobox: set id, search, targetRange in the store\n * Close the combobox if needed\n */\nexport const onChangeCombobox =\n  <V extends Value = Value, E extends PlateEditor<V> = PlateEditor<V>>(\n    editor: E\n  ) =>\n  () => {\n    const byId = comboboxSelectors.byId();\n    const activeId = comboboxSelectors.activeId();\n\n    let shouldClose = true;\n\n    for (const store of Object.values(byId)) {\n      const id = store.get.id();\n      const controlled = store.get.controlled?.();\n\n      if (controlled) {\n        // do not close controlled comboboxes\n        if (activeId === id) {\n          shouldClose = false;\n          break;\n        } else {\n          // do not open controlled comboboxes\n          continue;\n        }\n      }\n\n      const { selection } = editor;\n      if (!selection || !isCollapsed(selection)) {\n        continue;\n      }\n\n      const trigger = store.get.trigger();\n      const searchPattern = store.get.searchPattern?.();\n\n      const isCursorAfterTrigger = getTextFromTrigger(editor, {\n        at: Range.start(selection),\n        trigger,\n        searchPattern,\n      });\n      if (!isCursorAfterTrigger) {\n        continue;\n      }\n\n      const { range, textAfterTrigger } = isCursorAfterTrigger;\n\n      comboboxActions.open({\n        activeId: id,\n        text: textAfterTrigger,\n        targetRange: range,\n      });\n\n      shouldClose = false;\n      break;\n    }\n\n    if (shouldClose && comboboxSelectors.isOpen()) {\n      comboboxActions.reset();\n    }\n  };\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar IS_MAC = () => typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar ALIASES = () => ({\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC() ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n});\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES()[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","/**\n * Returns the next index in the list of an item that is not disabled.\n *\n * @param {number} moveAmount Number of positions to move. Negative to move backwards, positive forwards.\n * @param {number} baseIndex The initial position to move from.\n * @param {number} itemCount The total number of items.\n * @param {Function} getItemNodeFromIndex Used to check if item is disabled.\n * @param {boolean} circular Specify if navigation is circular. Default is true.\n * @returns {number} The new index. Returns baseIndex if item is not disabled. Returns next non-disabled item otherwise. If no non-disabled found it will return -1.\n */\nexport const getNextNonDisabledIndex = (\n  moveAmount: number,\n  baseIndex: number,\n  itemCount: number,\n  getItemNodeFromIndex: any,\n  circular: boolean\n): number => {\n  const currentElementNode = getItemNodeFromIndex(baseIndex);\n  if (!currentElementNode || !currentElementNode.hasAttribute('disabled')) {\n    return baseIndex;\n  }\n\n  if (moveAmount > 0) {\n    for (let index = baseIndex + 1; index < itemCount; index++) {\n      if (!getItemNodeFromIndex(index).hasAttribute('disabled')) {\n        return index;\n      }\n    }\n  } else {\n    for (let index = baseIndex - 1; index >= 0; index--) {\n      if (!getItemNodeFromIndex(index).hasAttribute('disabled')) {\n        return index;\n      }\n    }\n  }\n\n  if (circular) {\n    return moveAmount > 0\n      ? getNextNonDisabledIndex(1, 0, itemCount, getItemNodeFromIndex, false)\n      : getNextNonDisabledIndex(\n          -1,\n          itemCount - 1,\n          itemCount,\n          getItemNodeFromIndex,\n          false\n        );\n  }\n\n  return -1;\n};\n","import { getNextNonDisabledIndex } from './getNextNonDisabledIndex';\n\n/**\n * Returns the new index in the list, in a circular way. If next value is out of bonds from the total,\n * it will wrap to either 0 or itemCount - 1.\n *\n * @param {number} moveAmount Number of positions to move. Negative to move backwards, positive forwards.\n * @param {number} baseIndex The initial position to move from.\n * @param {number} itemCount The total number of items.\n * @param {Function} getItemNodeFromIndex Used to check if item is disabled.\n * @param {boolean} circular Specify if navigation is circular. Default is true.\n * @returns {number} The new index after the move.\n */\nexport const getNextWrappingIndex = (\n  moveAmount: number,\n  baseIndex: number,\n  itemCount: number,\n  getItemNodeFromIndex: any,\n  circular = true\n) => {\n  if (itemCount === 0) {\n    return -1;\n  }\n\n  const itemsLastIndex = itemCount - 1;\n\n  // noinspection SuspiciousTypeOfGuard\n  if (\n    typeof baseIndex !== 'number' ||\n    baseIndex < 0 ||\n    baseIndex >= itemCount\n  ) {\n    baseIndex = moveAmount > 0 ? -1 : itemsLastIndex + 1;\n  }\n\n  let newIndex = baseIndex + moveAmount;\n\n  if (newIndex < 0) {\n    newIndex = circular ? itemsLastIndex : 0;\n  } else if (newIndex > itemsLastIndex) {\n    newIndex = circular ? 0 : itemsLastIndex;\n  }\n\n  const nonDisabledNewIndex = getNextNonDisabledIndex(\n    moveAmount,\n    newIndex,\n    itemCount,\n    getItemNodeFromIndex,\n    circular\n  );\n\n  if (nonDisabledNewIndex === -1) {\n    return baseIndex >= itemCount ? -1 : baseIndex;\n  }\n\n  return nonDisabledNewIndex;\n};\n","import {\n  Hotkeys,\n  KeyboardHandlerReturnType,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-common';\nimport isHotkey from 'is-hotkey';\n\nimport {\n  comboboxActions,\n  comboboxSelectors,\n  getComboboxStoreById,\n} from './combobox.store';\nimport { getNextWrappingIndex } from './utils/getNextWrappingIndex';\n\n/**\n * If the combobox is open, handle:\n * - down (next item)\n * - up (previous item)\n * - escape (reset combobox)\n * - tab, enter (select item)\n */\nexport const onKeyDownCombobox =\n  <V extends Value = Value, E extends PlateEditor<V> = PlateEditor<V>>(\n    editor: E\n  ): KeyboardHandlerReturnType =>\n  (event) => {\n    const { highlightedIndex, filteredItems, activeId } =\n      comboboxSelectors.state();\n    const isOpen = comboboxSelectors.isOpen();\n\n    if (!isOpen) return;\n\n    const store = getComboboxStoreById(activeId);\n    if (!store) return;\n\n    const onSelectItem = store.get.onSelectItem();\n\n    if (isHotkey('down', event)) {\n      event.preventDefault();\n\n      const newIndex = getNextWrappingIndex(\n        1,\n        highlightedIndex,\n        filteredItems.length,\n        () => {},\n        true\n      );\n      comboboxActions.highlightedIndex(newIndex);\n      return;\n    }\n    if (isHotkey('up', event)) {\n      event.preventDefault();\n\n      const newIndex = getNextWrappingIndex(\n        -1,\n        highlightedIndex,\n        filteredItems.length,\n        () => {},\n        true\n      );\n      comboboxActions.highlightedIndex(newIndex);\n      return;\n    }\n    if (isHotkey('escape', event)) {\n      event.preventDefault();\n      comboboxActions.reset();\n      return;\n    }\n\n    if (Hotkeys.isTab(editor, event) || isHotkey('enter', event)) {\n      event.preventDefault();\n      event.stopPropagation();\n      if (filteredItems[highlightedIndex]) {\n        onSelectItem?.(editor, filteredItems[highlightedIndex]);\n      }\n    }\n  };\n","import { createPluginFactory } from '@udecode/plate-common';\n\nimport { onChangeCombobox } from './onChangeCombobox';\nimport { onKeyDownCombobox } from './onKeyDownCombobox';\n\nexport const KEY_COMBOBOX = 'combobox';\n\nexport const createComboboxPlugin = createPluginFactory({\n  key: KEY_COMBOBOX,\n  handlers: {\n    onChange: onChangeCombobox,\n    onKeyDown: onKeyDownCombobox,\n  },\n});\n","import { useEffect } from 'react';\n\nimport {\n  comboboxActions,\n  ComboboxControls,\n  Data,\n  NoData,\n  useActiveComboboxStore,\n  useComboboxSelectors,\n} from '..';\nimport { ComboboxProps } from '../types/ComboboxProps';\n\nexport type ComboboxContentProps<TData extends Data = NoData> = Omit<\n  ComboboxProps<TData>,\n  | 'id'\n  | 'trigger'\n  | 'searchPattern'\n  | 'onSelectItem'\n  | 'controlled'\n  | 'maxSuggestions'\n  | 'filter'\n  | 'sort'\n> & { combobox: ComboboxControls };\n\nexport type ComboboxContentRootProps<TData extends Data = NoData> =\n  ComboboxContentProps<TData> & { combobox: ComboboxControls };\n\nexport const useComboboxContentState = <TData extends Data = NoData>({\n  items,\n  combobox,\n}: ComboboxContentRootProps<TData>) => {\n  const targetRange = useComboboxSelectors.targetRange();\n  const activeComboboxStore = useActiveComboboxStore()!;\n  const text = useComboboxSelectors.text() ?? '';\n  const storeItems = useComboboxSelectors.items();\n  const filter = activeComboboxStore.use.filter?.();\n  const sort = activeComboboxStore.use.sort?.();\n  const maxSuggestions =\n    activeComboboxStore.use.maxSuggestions?.() ?? storeItems.length;\n\n  // Update items\n  useEffect(() => {\n    items && comboboxActions.items(items);\n  }, [items]);\n\n  // Filter items\n  useEffect(() => {\n    comboboxActions.filteredItems(\n      storeItems\n        .filter(\n          filter\n            ? filter(text)\n            : (value) => value.text.toLowerCase().startsWith(text.toLowerCase())\n        )\n        .sort(sort?.(text))\n        .slice(0, maxSuggestions)\n    );\n  }, [filter, sort, storeItems, maxSuggestions, text]);\n\n  return {\n    combobox,\n    targetRange,\n  };\n};\n\nexport const useComboboxContent = (\n  state: ReturnType<typeof useComboboxContentState>\n) => {\n  const menuProps = state.combobox\n    ? state.combobox.getMenuProps({}, { suppressRefError: true })\n    : { ref: null };\n\n  return {\n    menuProps,\n    targetRange: state.targetRange,\n  };\n};\n","import { useMemo } from 'react';\nimport { useCombobox } from 'downshift';\n\nimport { useComboboxSelectors } from '../combobox.store';\n\nexport type ComboboxControls = ReturnType<typeof useComboboxControls>;\n\nexport const useComboboxControls = () => {\n  const isOpen = useComboboxSelectors.isOpen();\n  const highlightedIndex = useComboboxSelectors.highlightedIndex();\n  const filteredItems = useComboboxSelectors.filteredItems();\n\n  const {\n    closeMenu,\n    getMenuProps,\n    getComboboxProps,\n    getInputProps,\n    getItemProps,\n  } = useCombobox({\n    isOpen,\n    highlightedIndex,\n    items: filteredItems,\n    circularNavigation: true,\n  });\n  getMenuProps({}, { suppressRefError: true });\n  getComboboxProps({}, { suppressRefError: true });\n  getInputProps({}, { suppressRefError: true });\n\n  return useMemo(\n    () => ({\n      closeMenu,\n      getMenuProps,\n      getItemProps,\n    }),\n    [closeMenu, getItemProps, getMenuProps]\n  );\n};\n","import { usePlateEditorRef } from '@udecode/plate-common';\n\nimport {\n  ComboboxControls,\n  comboboxSelectors,\n  Data,\n  getComboboxStoreById,\n  NoData,\n  TComboboxItem,\n  useComboboxSelectors,\n} from '..';\nimport { ComboboxContentProps } from './useComboboxContent';\n\nexport type ComboboxContentItemProps<TData extends Data = NoData> = {\n  index: number;\n  item: TComboboxItem<TData>;\n  combobox: ComboboxControls;\n} & Pick<ComboboxContentProps<TData>, 'onRenderItem'>;\n\nexport interface ComboboxItemProps<TData extends Data = NoData> {\n  item: TComboboxItem<TData>;\n  search: string;\n}\n\nexport const useComboboxItem = <TData extends Data = NoData>({\n  index,\n  item,\n  onRenderItem,\n  combobox,\n}: ComboboxContentItemProps<TData>) => {\n  const editor = usePlateEditorRef();\n  const text = useComboboxSelectors.text() ?? '';\n  const highlightedIndex = useComboboxSelectors.highlightedIndex();\n\n  const Item = onRenderItem\n    ? onRenderItem({ search: text, item: item as TComboboxItem<TData> })\n    : item.text;\n\n  const highlighted = index === highlightedIndex;\n\n  return {\n    props: {\n      'data-highlighted': highlighted,\n      ...combobox.getItemProps({\n        item,\n        index,\n      }),\n      onMouseDown: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n        e.preventDefault();\n\n        const onSelectItem = getComboboxStoreById(\n          comboboxSelectors.activeId()\n        )?.get.onSelectItem();\n        onSelectItem?.(editor, item);\n      },\n      children: Item,\n    },\n  };\n};\n"],"names":["createComboboxStore","state","createStore","id","comboboxStore","activeId","byId","highlightedIndex","items","filteredItems","targetRange","text","extendActions","set","get","setComboboxById","draft","open","mergeState","reset","extendSelectors","isOpen","useComboboxSelectors","use","comboboxSelectors","comboboxActions","getComboboxStoreById","useActiveComboboxStore","comboboxes","getTextFromTrigger","editor","at","trigger","searchPattern","escapedTrigger","escapeRegExp","triggerRegex","RegExp","start","end","getPointBefore","charRange","getRange","charText","getEditorString","match","range","textAfterTrigger","slice","length","onChangeCombobox","shouldClose","store","Object","values","_store$get$controlled","_store$get","_store$get$searchPatt","_store$get2","controlled","call","selection","isCollapsed","isCursorAfterTrigger","Range","getNextNonDisabledIndex","moveAmount","baseIndex","itemCount","getItemNodeFromIndex","circular","currentElementNode","hasAttribute","index","getNextWrappingIndex","itemsLastIndex","newIndex","nonDisabledNewIndex","onKeyDownCombobox","event","onSelectItem","isHotkey","preventDefault","Hotkeys","isTab","stopPropagation","KEY_COMBOBOX","createComboboxPlugin","createPluginFactory","key","handlers","onChange","onKeyDown","useComboboxContentState","combobox","_useComboboxSelectors","_activeComboboxStore$","_activeComboboxStore$2","_activeComboboxStore$3","_activeComboboxStore$4","_activeComboboxStore$5","_activeComboboxStore$6","_activeComboboxStore$7","activeComboboxStore","storeItems","filter","sort","maxSuggestions","useEffect","value","toLowerCase","startsWith","useComboboxContent","menuProps","getMenuProps","suppressRefError","ref","useComboboxControls","closeMenu","getComboboxProps","getInputProps","getItemProps","useCombobox","circularNavigation","useMemo","useComboboxItem","item","onRenderItem","usePlateEditorRef","Item","search","highlighted","props","onMouseDown","e","_getComboboxStoreById","children"],"mappings":"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","x_google_ignoreList":[3]}