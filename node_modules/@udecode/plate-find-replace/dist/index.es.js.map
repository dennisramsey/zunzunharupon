{"version":3,"file":"index.es.js","sources":["../src/decorateFindReplace.ts","../src/createFindReplacePlugin.ts"],"sourcesContent":["import {\n  DecorateEntry,\n  isText,\n  PlateEditor,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-common';\nimport { Range } from 'slate';\n\nimport { FindReplacePlugin } from './types';\n\nexport const decorateFindReplace =\n  <V extends Value = Value, E extends PlateEditor<V> = PlateEditor<V>>(\n    editor: E,\n    { key, type }: WithPlatePlugin<FindReplacePlugin, V, E>\n  ): DecorateEntry =>\n  ([node, path]) => {\n    const ranges: SearchRange[] = [];\n\n    const { search } = editor.pluginsByKey[key].options as FindReplacePlugin;\n    if (!search || !isText(node)) {\n      return ranges;\n    }\n\n    const { text } = node;\n    const parts = text.toLowerCase().split(search.toLowerCase());\n    let offset = 0;\n    parts.forEach((part, i) => {\n      if (i !== 0) {\n        ranges.push({\n          anchor: { path, offset: offset - search.length },\n          focus: { path, offset },\n          search,\n          [type]: true,\n        });\n      }\n      offset = offset + part.length + search.length;\n    });\n\n    return ranges;\n  };\n\ntype SearchRange = Range & {\n  search: string;\n};\n","import { createPluginFactory } from '@udecode/plate-common';\n\nimport { decorateFindReplace } from './decorateFindReplace';\nimport { FindReplacePlugin } from './types';\n\nexport const MARK_SEARCH_HIGHLIGHT = 'search_highlight';\n\nexport const createFindReplacePlugin = createPluginFactory<FindReplacePlugin>({\n  key: MARK_SEARCH_HIGHLIGHT,\n  isLeaf: true,\n  decorate: decorateFindReplace,\n});\n"],"names":["decorateFindReplace","editor","key","type","node","path","ranges","search","pluginsByKey","options","isText","text","parts","toLowerCase","split","offset","forEach","part","i","push","anchor","length","focus","MARK_SEARCH_HIGHLIGHT","createFindReplacePlugin","createPluginFactory","isLeaf","decorate"],"mappings":";;AAWaA,MAAAA,mBAAmB,GAC9BA,CACEC,MAAS,EACT;EAAEC,GAAG;AAAEC,EAAAA,IAAAA;AAA+C,CAAC,KAEzD,CAAC,CAACC,IAAI,EAAEC,IAAI,CAAC,KAAK;EAChB,MAAMC,MAAqB,GAAG,EAAE,CAAA;EAEhC,MAAM;AAAEC,IAAAA,MAAAA;GAAQ,GAAGN,MAAM,CAACO,YAAY,CAACN,GAAG,CAAC,CAACO,OAA4B,CAAA;EACxE,IAAI,CAACF,MAAM,IAAI,CAACG,MAAM,CAACN,IAAI,CAAC,EAAE;AAC5B,IAAA,OAAOE,MAAM,CAAA;AACf,GAAA;EAEA,MAAM;AAAEK,IAAAA,IAAAA;AAAK,GAAC,GAAGP,IAAI,CAAA;AACrB,EAAA,MAAMQ,KAAK,GAAGD,IAAI,CAACE,WAAW,EAAE,CAACC,KAAK,CAACP,MAAM,CAACM,WAAW,EAAE,CAAC,CAAA;EAC5D,IAAIE,MAAM,GAAG,CAAC,CAAA;AACdH,EAAAA,KAAK,CAACI,OAAO,CAAC,CAACC,IAAI,EAAEC,CAAC,KAAK;IACzB,IAAIA,CAAC,KAAK,CAAC,EAAE;MACXZ,MAAM,CAACa,IAAI,CAAC;AACVC,QAAAA,MAAM,EAAE;UAAEf,IAAI;AAAEU,UAAAA,MAAM,EAAEA,MAAM,GAAGR,MAAM,CAACc,MAAAA;SAAQ;AAChDC,QAAAA,KAAK,EAAE;UAAEjB,IAAI;AAAEU,UAAAA,MAAAA;SAAQ;QACvBR,MAAM;AACN,QAAA,CAACJ,IAAI,GAAG,IAAA;AACV,OAAC,CAAC,CAAA;AACJ,KAAA;IACAY,MAAM,GAAGA,MAAM,GAAGE,IAAI,CAACI,MAAM,GAAGd,MAAM,CAACc,MAAM,CAAA;AAC/C,GAAC,CAAC,CAAA;AAEF,EAAA,OAAOf,MAAM,CAAA;AACf;;ACnCK,MAAMiB,qBAAqB,GAAG,mBAAkB;AAE1CC,MAAAA,uBAAuB,GAAGC,mBAAmB,CAAoB;AAC5EvB,EAAAA,GAAG,EAAEqB,qBAAqB;AAC1BG,EAAAA,MAAM,EAAE,IAAI;AACZC,EAAAA,QAAQ,EAAE3B,mBAAAA;AACZ,CAAC;;;;"}