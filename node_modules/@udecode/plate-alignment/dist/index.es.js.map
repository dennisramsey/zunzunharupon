{"version":3,"file":"index.es.js","sources":["../src/createAlignPlugin.ts","../src/hooks/useAlignDropdownMenu.ts","../src/transforms/setAlign.ts"],"sourcesContent":["import {\n  createPluginFactory,\n  ELEMENT_DEFAULT,\n  getPluginType,\n  mapInjectPropsToPlugin,\n} from '@udecode/plate-common';\n\nexport const KEY_ALIGN = 'align';\n\n/**\n * Creates a plugin that adds alignment functionality to the editor.\n */\nexport const createAlignPlugin = createPluginFactory({\n  key: KEY_ALIGN,\n  then: (editor) => ({\n    inject: {\n      props: {\n        nodeKey: KEY_ALIGN,\n        defaultNodeValue: 'left',\n        styleKey: 'textAlign',\n        validNodeValues: ['left', 'center', 'right', 'justify'],\n        validTypes: [getPluginType(editor, ELEMENT_DEFAULT)],\n      },\n    },\n    then: (_, plugin) =>\n      mapInjectPropsToPlugin(editor, plugin, {\n        deserializeHtml: {\n          getNode: (el, node) => {\n            if (el.style.textAlign) {\n              node[plugin.key] = el.style.textAlign;\n            }\n          },\n        },\n      }),\n  }),\n});\n","import {\n  findNode,\n  focusEditor,\n  isCollapsed,\n  isDefined,\n  usePlateEditorRef,\n  usePlateEditorState,\n} from '@udecode/plate-common';\n\nimport { Alignment, KEY_ALIGN, setAlign } from '../index';\n\nexport const useAlignDropdownMenuState = () => {\n  const editor = usePlateEditorState();\n\n  let value: Alignment = 'left';\n  if (isCollapsed(editor?.selection)) {\n    const entry = findNode(editor!, {\n      match: (n) => isDefined(n[KEY_ALIGN]),\n    });\n    if (entry) {\n      const nodeValue = entry[0][KEY_ALIGN] as string;\n      if (nodeValue === 'right') value = 'right';\n      if (nodeValue === 'center') value = 'center';\n      if (nodeValue === 'justify') value = 'justify';\n    }\n  }\n\n  return {\n    value,\n  };\n};\n\nexport const useAlignDropdownMenu = ({\n  value,\n}: ReturnType<typeof useAlignDropdownMenuState>) => {\n  const editor = usePlateEditorRef();\n\n  return {\n    radioGroupProps: {\n      value,\n      onValueChange: (newValue: string) => {\n        setAlign(editor, {\n          value: newValue as Alignment,\n          key: KEY_ALIGN,\n        });\n\n        focusEditor(editor);\n      },\n    },\n  };\n};\n","import {\n  ENode,\n  getPluginInjectProps,\n  isBlock,\n  PlateEditor,\n  PlatePluginKey,\n  setElements,\n  SetNodesOptions,\n  TNodeMatch,\n  unsetNodes,\n  Value,\n} from '@udecode/plate-common';\n\nimport { KEY_ALIGN } from '../createAlignPlugin';\nimport { Alignment } from '../types';\n\nexport const setAlign = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    key = KEY_ALIGN,\n    value,\n    setNodesOptions,\n  }: { value: Alignment; setNodesOptions?: SetNodesOptions<V> } & PlatePluginKey\n) => {\n  const { validTypes, defaultNodeValue, nodeKey } = getPluginInjectProps(\n    editor,\n    key\n  );\n\n  const match: TNodeMatch<ENode<Value>> = (n) => {\n    return (\n      isBlock(editor, n) &&\n      !!validTypes &&\n      validTypes.includes(n.type as string)\n    );\n  };\n\n  if (value === defaultNodeValue) {\n    unsetNodes(editor, nodeKey!, {\n      match,\n      ...setNodesOptions,\n    });\n  } else {\n    setElements(\n      editor,\n      { [nodeKey!]: value },\n      {\n        match: match as any,\n        ...setNodesOptions,\n      }\n    );\n  }\n};\n"],"names":["KEY_ALIGN","createAlignPlugin","createPluginFactory","key","then","editor","inject","props","nodeKey","defaultNodeValue","styleKey","validNodeValues","validTypes","getPluginType","ELEMENT_DEFAULT","_","plugin","mapInjectPropsToPlugin","deserializeHtml","getNode","el","node","style","textAlign","useAlignDropdownMenuState","usePlateEditorState","value","isCollapsed","selection","entry","findNode","match","n","isDefined","nodeValue","useAlignDropdownMenu","usePlateEditorRef","radioGroupProps","onValueChange","newValue","setAlign","focusEditor","setNodesOptions","getPluginInjectProps","isBlock","includes","type","unsetNodes","setElements"],"mappings":";;AAOO,MAAMA,SAAS,GAAG,QAAO;;AAEhC;AACA;AACA;AACaC,MAAAA,iBAAiB,GAAGC,mBAAmB,CAAC;AACnDC,EAAAA,GAAG,EAAEH,SAAS;EACdI,IAAI,EAAGC,MAAM,KAAM;AACjBC,IAAAA,MAAM,EAAE;AACNC,MAAAA,KAAK,EAAE;AACLC,QAAAA,OAAO,EAAER,SAAS;AAClBS,QAAAA,gBAAgB,EAAE,MAAM;AACxBC,QAAAA,QAAQ,EAAE,WAAW;QACrBC,eAAe,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,CAAC;AACvDC,QAAAA,UAAU,EAAE,CAACC,aAAa,CAACR,MAAM,EAAES,eAAe,CAAC,CAAA;AACrD,OAAA;KACD;IACDV,IAAI,EAAEA,CAACW,CAAC,EAAEC,MAAM,KACdC,sBAAsB,CAACZ,MAAM,EAAEW,MAAM,EAAE;AACrCE,MAAAA,eAAe,EAAE;AACfC,QAAAA,OAAO,EAAEA,CAACC,EAAE,EAAEC,IAAI,KAAK;AACrB,UAAA,IAAID,EAAE,CAACE,KAAK,CAACC,SAAS,EAAE;YACtBF,IAAI,CAACL,MAAM,CAACb,GAAG,CAAC,GAAGiB,EAAE,CAACE,KAAK,CAACC,SAAS,CAAA;AACvC,WAAA;AACF,SAAA;AACF,OAAA;KACD,CAAA;GACJ,CAAA;AACH,CAAC;;ACxBYC,MAAAA,yBAAyB,GAAGA,MAAM;AAC7C,EAAA,MAAMnB,MAAM,GAAGoB,mBAAmB,EAAE,CAAA;EAEpC,IAAIC,KAAgB,GAAG,MAAM,CAAA;EAC7B,IAAIC,WAAW,CAACtB,MAAM,KAANA,IAAAA,IAAAA,MAAM,uBAANA,MAAM,CAAEuB,SAAS,CAAC,EAAE;AAClC,IAAA,MAAMC,KAAK,GAAGC,QAAQ,CAACzB,MAAM,EAAG;MAC9B0B,KAAK,EAAGC,CAAC,IAAKC,SAAS,CAACD,CAAC,CAAChC,SAAS,CAAC,CAAA;AACtC,KAAC,CAAC,CAAA;AACF,IAAA,IAAI6B,KAAK,EAAE;MACT,MAAMK,SAAS,GAAGL,KAAK,CAAC,CAAC,CAAC,CAAC7B,SAAS,CAAW,CAAA;AAC/C,MAAA,IAAIkC,SAAS,KAAK,OAAO,EAAER,KAAK,GAAG,OAAO,CAAA;AAC1C,MAAA,IAAIQ,SAAS,KAAK,QAAQ,EAAER,KAAK,GAAG,QAAQ,CAAA;AAC5C,MAAA,IAAIQ,SAAS,KAAK,SAAS,EAAER,KAAK,GAAG,SAAS,CAAA;AAChD,KAAA;AACF,GAAA;EAEA,OAAO;AACLA,IAAAA,KAAAA;GACD,CAAA;AACH,EAAC;AAEM,MAAMS,oBAAoB,GAAGA,CAAC;AACnCT,EAAAA,KAAAA;AAC4C,CAAC,KAAK;AAClD,EAAA,MAAMrB,MAAM,GAAG+B,iBAAiB,EAAE,CAAA;EAElC,OAAO;AACLC,IAAAA,eAAe,EAAE;MACfX,KAAK;MACLY,aAAa,EAAGC,QAAgB,IAAK;QACnCC,QAAQ,CAACnC,MAAM,EAAE;AACfqB,UAAAA,KAAK,EAAEa,QAAqB;AAC5BpC,UAAAA,GAAG,EAAEH,SAAAA;AACP,SAAC,CAAC,CAAA;QAEFyC,WAAW,CAACpC,MAAM,CAAC,CAAA;AACrB,OAAA;AACF,KAAA;GACD,CAAA;AACH;;AClCamC,MAAAA,QAAQ,GAAGA,CACtBnC,MAAsB,EACtB;AACEF,EAAAA,GAAG,GAAGH,SAAS;EACf0B,KAAK;AACLgB,EAAAA,eAAAA;AAC2E,CAAC,KAC3E;EACH,MAAM;IAAE9B,UAAU;IAAEH,gBAAgB;AAAED,IAAAA,OAAAA;AAAQ,GAAC,GAAGmC,oBAAoB,CACpEtC,MAAM,EACNF,GACF,CAAC,CAAA;EAED,MAAM4B,KAA+B,GAAIC,CAAC,IAAK;AAC7C,IAAA,OACEY,OAAO,CAACvC,MAAM,EAAE2B,CAAC,CAAC,IAClB,CAAC,CAACpB,UAAU,IACZA,UAAU,CAACiC,QAAQ,CAACb,CAAC,CAACc,IAAc,CAAC,CAAA;GAExC,CAAA;EAED,IAAIpB,KAAK,KAAKjB,gBAAgB,EAAE;AAC9BsC,IAAAA,UAAU,CAAC1C,MAAM,EAAEG,OAAO,EAAG;MAC3BuB,KAAK;MACL,GAAGW,eAAAA;AACL,KAAC,CAAC,CAAA;AACJ,GAAC,MAAM;IACLM,WAAW,CACT3C,MAAM,EACN;AAAE,MAAA,CAACG,OAAO,GAAIkB,KAAAA;AAAM,KAAC,EACrB;AACEK,MAAAA,KAAK,EAAEA,KAAY;MACnB,GAAGW,eAAAA;AACL,KACF,CAAC,CAAA;AACH,GAAA;AACF;;;;"}