{"version":3,"file":"index.js","sources":["../src/createLineHeightPlugin.ts","../src/hooks/useLineHeightDropdownMenu.ts","../src/transforms/setLineHeight.ts"],"sourcesContent":["import {\n  createPluginFactory,\n  ELEMENT_DEFAULT,\n  getPluginType,\n  mapInjectPropsToPlugin,\n} from '@udecode/plate-common';\n\nexport const KEY_LINE_HEIGHT = 'lineHeight';\n\n/**\n * Enables support for text alignment, useful to align your content\n * to left, right and center it.\n */\nexport const createLineHeightPlugin = createPluginFactory({\n  key: KEY_LINE_HEIGHT,\n  inject: {\n    props: {\n      nodeKey: KEY_LINE_HEIGHT,\n      defaultNodeValue: 1.5,\n    },\n  },\n  then: (editor) => ({\n    inject: {\n      props: {\n        validTypes: [getPluginType(editor, ELEMENT_DEFAULT)],\n      },\n    },\n    then: (_, plugin) =>\n      mapInjectPropsToPlugin(editor, plugin, {\n        deserializeHtml: {\n          getNode: (el, node) => {\n            if (el.style.lineHeight) {\n              node[plugin.key] = el.style.lineHeight;\n            }\n          },\n        },\n      }),\n  }),\n});\n","import {\n  focusEditor,\n  getBlockAbove,\n  getPluginInjectProps,\n  isCollapsed,\n  TElement,\n  usePlateEditorRef,\n  usePlateEditorState,\n} from '@udecode/plate-common';\n\nimport { KEY_LINE_HEIGHT, setLineHeight } from '../index';\n\nexport const useLineHeightDropdownMenuState = () => {\n  const editor = usePlateEditorState();\n  const { validNodeValues: values = [], defaultNodeValue } =\n    getPluginInjectProps(editor, KEY_LINE_HEIGHT);\n  let value: string | undefined;\n\n  if (isCollapsed(editor?.selection)) {\n    const entry = getBlockAbove<TElement>(editor);\n    if (entry) {\n      value =\n        values.find((item) => item === entry[0][KEY_LINE_HEIGHT]) ??\n        defaultNodeValue;\n    }\n  }\n\n  return {\n    value,\n    values,\n  };\n};\n\nexport const useLineHeightDropdownMenu = ({\n  value,\n}: ReturnType<typeof useLineHeightDropdownMenuState>) => {\n  const editor = usePlateEditorRef();\n\n  return {\n    radioGroupProps: {\n      value,\n      onValueChange: (newValue: string) => {\n        setLineHeight(editor, {\n          value: Number(newValue),\n        });\n        focusEditor(editor);\n      },\n    },\n  };\n};\n","import {\n  getPluginInjectProps,\n  isBlock,\n  PlateEditor,\n  setElements,\n  SetNodesOptions,\n  TNodeMatch,\n  unsetNodes,\n  Value,\n} from '@udecode/plate-common';\n\nimport { KEY_LINE_HEIGHT } from '../createLineHeightPlugin';\n\nexport const setLineHeight = <V extends Value>(\n  editor: PlateEditor<V>,\n  {\n    value,\n    setNodesOptions,\n  }: { value: number; setNodesOptions?: SetNodesOptions<V> }\n): void => {\n  const { validTypes, defaultNodeValue, nodeKey } = getPluginInjectProps(\n    editor,\n    KEY_LINE_HEIGHT\n  );\n\n  const match: TNodeMatch = (n) =>\n    isBlock(editor, n) && !!validTypes && validTypes.includes(n.type as string);\n\n  if (value === defaultNodeValue) {\n    unsetNodes(editor, nodeKey!, {\n      match,\n      ...setNodesOptions,\n    });\n  } else {\n    setElements(\n      editor,\n      { [nodeKey!]: value },\n      {\n        match: match as any,\n        ...setNodesOptions,\n      }\n    );\n  }\n};\n"],"names":["KEY_LINE_HEIGHT","createLineHeightPlugin","createPluginFactory","key","inject","props","nodeKey","defaultNodeValue","then","editor","validTypes","getPluginType","ELEMENT_DEFAULT","_","plugin","mapInjectPropsToPlugin","deserializeHtml","getNode","el","node","style","lineHeight","useLineHeightDropdownMenuState","usePlateEditorState","validNodeValues","values","getPluginInjectProps","value","isCollapsed","selection","entry","getBlockAbove","_values$find","find","item","useLineHeightDropdownMenu","usePlateEditorRef","radioGroupProps","onValueChange","newValue","setLineHeight","Number","focusEditor","setNodesOptions","match","n","isBlock","includes","type","unsetNodes","setElements"],"mappings":"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"}